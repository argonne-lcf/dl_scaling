:::MLLOG {"namespace": "", "time_ms": 1662758313518, "event_type": "POINT_IN_TIME", "key": "cache_clear", "value": null, "metadata": {"file": "./main.py", "lineno": 46, "instance": 0}}
:::MLLOG {"namespace": "", "time_ms": 1662758314344, "event_type": "INTERVAL_START", "key": "init_start", "value": null, "metadata": {"file": "./main.py", "lineno": 47, "instance": 0}}
:::MLLOG {"namespace": "", "time_ms": 1662758314344, "event_type": "POINT_IN_TIME", "key": "submission_benchmark", "value": "cosmoflow", "metadata": {"file": "./main.py", "lineno": 51, "instance": 0}}
:::MLLOG {"namespace": "", "time_ms": 1662758314345, "event_type": "POINT_IN_TIME", "key": "submission_org", "value": "NVIDIA", "metadata": {"file": "./main.py", "lineno": 53, "instance": 0}}
:::MLLOG {"namespace": "", "time_ms": 1662758314345, "event_type": "POINT_IN_TIME", "key": "submission_division", "value": "closed", "metadata": {"file": "./main.py", "lineno": 55, "instance": 0}}
:::MLLOG {"namespace": "", "time_ms": 1662758314345, "event_type": "POINT_IN_TIME", "key": "submission_status", "value": "onprem", "metadata": {"file": "./main.py", "lineno": 57, "instance": 0}}
:::MLLOG {"namespace": "", "time_ms": 1662758314345, "event_type": "POINT_IN_TIME", "key": "submission_platform", "value": "8.0xNVIDIA DGX A100", "metadata": {"file": "./main.py", "lineno": 59, "instance": 0}}
:::MLLOG {"namespace": "", "time_ms": 1662758314345, "event_type": "POINT_IN_TIME", "key": "number_of_nodes", "value": 8, "metadata": {"file": "./main.py", "lineno": 62, "instance": 0}}
:::MLLOG {"namespace": "", "time_ms": 1662758314345, "event_type": "POINT_IN_TIME", "key": "accelerators_per_node", "value": 4, "metadata": {"file": "./main.py", "lineno": 64, "instance": 0}}
[2022-09-09 16:18:37,407][torch.distributed.distributed_c10d][INFO] - Added key: store_based_barrier_key:1 to store for rank: 0
[2022-09-09 16:18:37,523][torch.distributed.distributed_c10d][INFO] - Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 32 nodes.
:::MLLOG {"namespace": "", "time_ms": 1662758317739, "event_type": "POINT_IN_TIME", "key": "dropout", "value": 0.5, "metadata": {"file": "./main.py", "lineno": 110, "instance": 0}}
:::MLLOG {"namespace": "", "time_ms": 1662758319395, "event_type": "POINT_IN_TIME", "key": "opt_weight_decay", "value": 0, "metadata": {"file": "/lus/grand/projects/datascience/hzheng/mlperf-2022/optimized-hpc/cosmoflow/pytorch/optimizer.py", "lineno": 63, "instance": 0}}
:::MLLOG {"namespace": "", "time_ms": 1662758319395, "event_type": "POINT_IN_TIME", "key": "opt_name", "value": "sgd", "metadata": {"file": "/lus/grand/projects/datascience/hzheng/mlperf-2022/optimized-hpc/cosmoflow/pytorch/optimizer.py", "lineno": 65, "instance": 0}}
:::MLLOG {"namespace": "", "time_ms": 1662758319395, "event_type": "POINT_IN_TIME", "key": "opt_base_learning_rate", "value": 0.008, "metadata": {"file": "/lus/grand/projects/datascience/hzheng/mlperf-2022/optimized-hpc/cosmoflow/pytorch/optimizer.py", "lineno": 96, "instance": 0}}
:::MLLOG {"namespace": "", "time_ms": 1662758319396, "event_type": "POINT_IN_TIME", "key": "opt_learning_rate_warmup_epochs", "value": 4, "metadata": {"file": "/lus/grand/projects/datascience/hzheng/mlperf-2022/optimized-hpc/cosmoflow/pytorch/optimizer.py", "lineno": 98, "instance": 0}}
:::MLLOG {"namespace": "", "time_ms": 1662758319396, "event_type": "POINT_IN_TIME", "key": "opt_learning_rate_warmup_factor", "value": 8, "metadata": {"file": "/lus/grand/projects/datascience/hzheng/mlperf-2022/optimized-hpc/cosmoflow/pytorch/optimizer.py", "lineno": 100, "instance": 0}}
:::MLLOG {"namespace": "", "time_ms": 1662758319396, "event_type": "POINT_IN_TIME", "key": "opt_learning_rate_decay_boundary_epochs", "value": [16, 32], "metadata": {"file": "/lus/grand/projects/datascience/hzheng/mlperf-2022/optimized-hpc/cosmoflow/pytorch/optimizer.py", "lineno": 102, "instance": 0}}
:::MLLOG {"namespace": "", "time_ms": 1662758319396, "event_type": "POINT_IN_TIME", "key": "opt_learning_rate_decay_factor", "value": [0.25, 0.125], "metadata": {"file": "/lus/grand/projects/datascience/hzheng/mlperf-2022/optimized-hpc/cosmoflow/pytorch/optimizer.py", "lineno": 104, "instance": 0}}
:::MLLOG {"namespace": "", "time_ms": 1662758319396, "event_type": "POINT_IN_TIME", "key": "global_batch_size", "value": 32, "metadata": {"file": "./main.py", "lineno": 124, "instance": 0}}
:::MLLOG {"namespace": "", "time_ms": 1662758319396, "event_type": "POINT_IN_TIME", "key": "train_samples", "value": 262144, "metadata": {"file": "./main.py", "lineno": 126, "instance": 0}}
:::MLLOG {"namespace": "", "time_ms": 1662758319397, "event_type": "POINT_IN_TIME", "key": "eval_samples", "value": 65536, "metadata": {"file": "./main.py", "lineno": 128, "instance": 0}}
[2022-09-09 16:18:41,178][torch.nn.parallel.distributed][INFO] - Reducer buckets have been rebuilt in this iteration.
:::MLLOG {"namespace": "", "time_ms": 1662758327279, "event_type": "INTERVAL_END", "key": "init_stop", "value": null, "metadata": {"file": "/lus/grand/projects/datascience/hzheng/mlperf-2022/optimized-hpc/cosmoflow/pytorch/utils/utils.py", "lineno": 216, "instance": 0}}
:::MLLOG {"namespace": "", "time_ms": 1662758327280, "event_type": "INTERVAL_START", "key": "run_start", "value": null, "metadata": {"file": "./main.py", "lineno": 148, "instance": 0}}
:::MLLOG {"namespace": "", "time_ms": 1662758327280, "event_type": "INTERVAL_START", "key": "staging_start", "value": null, "metadata": {"file": "./main.py", "lineno": 151, "instance": 0}}
Staging non distributed files (8192)
Staging non distributed files (2048)
:::MLLOG {"namespace": "", "time_ms": 1662758904183, "event_type": "INTERVAL_END", "key": "staging_stop", "value": null, "metadata": {"file": "/lus/grand/projects/datascience/hzheng/mlperf-2022/optimized-hpc/cosmoflow/pytorch/utils/utils.py", "lineno": 216, "staging_duration": -1662758327.280747, "instance": 0}}
/home/hzheng/.local/polaris/conda/2022-07-19/lib/python3.8/site-packages/nvidia/dali/plugin/base_iterator.py:192: Warning: Please set `reader_name` and don't set last_batch_padded and size manually whenever possible. This may lead, in some situations, to missing some samples or returning duplicated ones. Check the Sharding section of the documentation for more details.
  _iterator_deprecation_warning()
Error executing job with overrides: ['++data.stage=/dev/shm', '+mpi.local_size=4', '+wandb=True']
Traceback (most recent call last):
  File "./main.py", line 210, in main
    return CosmoflowMain(cfg).exec()
  File "/lus/grand/projects/datascience/hzheng/mlperf-2022/optimized-hpc/cosmoflow/pytorch/utils/app.py", line 37, in exec
    return self.run()
  File "./main.py", line 165, in run
    train_iterator = iter(self._training_pipeline)
  File "/lus/grand/projects/datascience/hzheng/mlperf-2022/optimized-hpc/cosmoflow/pytorch/data/dali_core.py", line 83, in __iter__
    return InputMultiplierIter(self._pipeline,
  File "/lus/grand/projects/datascience/hzheng/mlperf-2022/optimized-hpc/cosmoflow/pytorch/data/dali_core.py", line 61, in __init__
    self._dali_iterator = dali_pytorch.DALIGenericIterator(
  File "/home/hzheng/.local/polaris/conda/2022-07-19/lib/python3.8/site-packages/nvidia/dali/plugin/pytorch.py", line 183, in __init__
    _DaliBaseIterator.__init__(self,
  File "/home/hzheng/.local/polaris/conda/2022-07-19/lib/python3.8/site-packages/nvidia/dali/plugin/base_iterator.py", line 199, in __init__
    p.build()
  File "/home/hzheng/.local/polaris/conda/2022-07-19/lib/python3.8/site-packages/nvidia/dali/pipeline.py", line 827, in build
    self._pipe.Build(self._generate_build_args())
RuntimeError: Critical error when building pipeline:
Error when constructing operator: readers___TFRecord encountered:
[/opt/dali/dali/operators/reader/loader/indexed_file_loader.h:105] Assert on "fin.good()" failed: Failed to open file /dev/shm/train/univ_ics_2019-03_a11469332_027.tfrecord.idx
Stacktrace (76 entries):
[frame 0]: /home/hzheng/.local/polaris/conda/2022-07-19/lib/python3.8/site-packages/nvidia/dali/libdali_operators.so(+0x5a6262) [0x14d1e303e262]
[frame 1]: /home/hzheng/.local/polaris/conda/2022-07-19/lib/python3.8/site-packages/nvidia/dali/libdali_operators.so(+0x336a6fd) [0x14d1e5e026fd]
[frame 2]: /home/hzheng/.local/polaris/conda/2022-07-19/lib/python3.8/site-packages/nvidia/dali/libdali_operators.so(+0x3369bf9) [0x14d1e5e01bf9]
[frame 3]: /home/hzheng/.local/polaris/conda/2022-07-19/lib/python3.8/site-packages/nvidia/dali/libdali_operators.so(+0x335c4e9) [0x14d1e5df44e9]
[frame 4]: /home/hzheng/.local/polaris/conda/2022-07-19/lib/python3.8/site-packages/nvidia/dali/libdali_operators.so(+0x336daf8) [0x14d1e5e05af8]
[frame 5]: /home/hzheng/.local/polaris/conda/2022-07-19/lib/python3.8/site-packages/nvidia/dali/libdali_operators.so(+0x336e002) [0x14d1e5e06002]
[frame 6]: /home/hzheng/.local/polaris/conda/2022-07-19/lib/python3.8/site-packages/nvidia/dali/libdali_operators.so(std::_Function_handler<std::unique_ptr<dali::OperatorBase, std::default_delete<dali::OperatorBase> > (dali::OpSpec const&), std::unique_ptr<dali::OperatorBase, std::default_delete<dali::OperatorBase> > (*)(dali::OpSpec const&)>::_M_invoke(std::_Any_data const&, dali::OpSpec const&)+0xc) [0x14d1e303755c]
[frame 7]: /home/hzheng/.local/polaris/conda/2022-07-19/lib/python3.8/site-packages/nvidia/dali/libdali.so(+0x159281) [0x14d2131ab281]
[frame 8]: /home/hzheng/.local/polaris/conda/2022-07-19/lib/python3.8/site-packages/nvidia/dali/libdali.so(dali::InstantiateOperator(dali::OpSpec const&)+0x264) [0x14d2131a8914]
[frame 9]: /home/hzheng/.local/polaris/conda/2022-07-19/lib/python3.8/site-packages/nvidia/dali/libdali.so(dali::OpGraph::InstantiateOperators()+0x9a) [0x14d21315ff3a]
[frame 10]: /home/hzheng/.local/polaris/conda/2022-07-19/lib/python3.8/site-packages/nvidia/dali/libdali.so(dali::Pipeline::Build(std::vector<dali::PipelineOutputDesc, std::allocator<dali::PipelineOutputDesc> >)+0xa08) [0x14d2131c4e18]
[frame 11]: /home/hzheng/.local/polaris/conda/2022-07-19/lib/python3.8/site-packages/nvidia/dali/backend_impl.cpython-38-x86_64-linux-gnu.so(+0x5ec52) [0x14d1ef801c52]
[frame 12]: /home/hzheng/.local/polaris/conda/2022-07-19/lib/python3.8/site-packages/nvidia/dali/backend_impl.cpython-38-x86_64-linux-gnu.so(+0xa7c15) [0x14d1ef84ac15]
[frame 13]: /var/run/palsd/a1b478ab-f7f5-4573-8567-e5e0d3011204/files/python(+0x13c00e) [0x55730ee4500e]
[frame 14]: /var/run/palsd/a1b478ab-f7f5-4573-8567-e5e0d3011204/files/python(_PyObject_MakeTpCall+0x3bf) [0x55730ee3a13f]
[frame 15]: /var/run/palsd/a1b478ab-f7f5-4573-8567-e5e0d3011204/files/python(+0x166ca0) [0x55730ee6fca0]
[frame 16]: /var/run/palsd/a1b478ab-f7f5-4573-8567-e5e0d3011204/files/python(_PyEval_EvalFrameDefault+0x4f83) [0x55730eee4923]
[frame 17]: /var/run/palsd/a1b478ab-f7f5-4573-8567-e5e0d3011204/files/python(_PyEval_EvalCodeWithName+0x260) [0x55730eed5600]
[frame 18]: /var/run/palsd/a1b478ab-f7f5-4573-8567-e5e0d3011204/files/python(_PyFunction_Vectorcall+0x534) [0x55730eed6b64]
[frame 19]: /var/run/palsd/a1b478ab-f7f5-4573-8567-e5e0d3011204/files/python(_PyEval_EvalFrameDefault+0x4c0) [0x55730eedfe60]
[frame 20]: /var/run/palsd/a1b478ab-f7f5-4573-8567-e5e0d3011204/files/python(_PyEval_EvalCodeWithName+0x260) [0x55730eed5600]
[frame 21]: /var/run/palsd/a1b478ab-f7f5-4573-8567-e5e0d3011204/files/python(_PyFunction_Vectorcall+0x594) [0x55730eed6bc4]
[frame 22]: /var/run/palsd/a1b478ab-f7f5-4573-8567-e5e0d3011204/files/python(_PyEval_EvalFrameDefault+0x1510) [0x55730eee0eb0]
[frame 23]: /var/run/palsd/a1b478ab-f7f5-4573-8567-e5e0d3011204/files/python(_PyEval_EvalCodeWithName+0x260) [0x55730eed5600]
[frame 24]: /var/run/palsd/a1b478ab-f7f5-4573-8567-e5e0d3011204/files/python(_PyFunction_Vectorcall+0x594) [0x55730eed6bc4]
[frame 25]: /var/run/palsd/a1b478ab-f7f5-4573-8567-e5e0d3011204/files/python(+0x1b97da) [0x55730eec27da]
[frame 26]: /var/run/palsd/a1b478ab-f7f5-4573-8567-e5e0d3011204/files/python(_PyObject_MakeTpCall+0x228) [0x55730ee39fa8]
[frame 27]: /var/run/palsd/a1b478ab-f7f5-4573-8567-e5e0d3011204/files/python(_PyEval_EvalFrameDefault+0x546a) [0x55730eee4e0a]
[frame 28]: /var/run/palsd/a1b478ab-f7f5-4573-8567-e5e0d3011204/files/python(_PyEval_EvalCodeWithName+0x260) [0x55730eed5600]
[frame 29]: /var/run/palsd/a1b478ab-f7f5-4573-8567-e5e0d3011204/files/python(_PyFunction_Vectorcall+0x594) [0x55730eed6bc4]
[frame 30]: /var/run/palsd/a1b478ab-f7f5-4573-8567-e5e0d3011204/files/python(+0x1b9698) [0x55730eec2698]
[frame 31]: /var/run/palsd/a1b478ab-f7f5-4573-8567-e5e0d3011204/files/python(_PyObject_MakeTpCall+0x228) [0x55730ee39fa8]
[frame 32]: /var/run/palsd/a1b478ab-f7f5-4573-8567-e5e0d3011204/files/python(_PyEval_EvalFrameDefault+0x4eff) [0x55730eee489f]
[frame 33]: /var/run/palsd/a1b478ab-f7f5-4573-8567-e5e0d3011204/files/python(_PyFunction_Vectorcall+0x1b7) [0x55730eed67e7]
[frame 34]: /var/run/palsd/a1b478ab-f7f5-4573-8567-e5e0d3011204/files/python(+0x13bc92) [0x55730ee44c92]
[frame 35]: /var/run/palsd/a1b478ab-f7f5-4573-8567-e5e0d3011204/files/python(+0x17958e) [0x55730ee8258e]
[frame 36]: /var/run/palsd/a1b478ab-f7f5-4573-8567-e5e0d3011204/files/python(PyObject_GetIter+0x13) [0x55730ee410d3]
[frame 37]: /var/run/palsd/a1b478ab-f7f5-4573-8567-e5e0d3011204/files/python(+0x13b23d) [0x55730ee4423d]
[frame 38]: /var/run/palsd/a1b478ab-f7f5-4573-8567-e5e0d3011204/files/python(_PyEval_EvalFrameDefault+0x71b) [0x55730eee00bb]
[frame 39]: /var/run/palsd/a1b478ab-f7f5-4573-8567-e5e0d3011204/files/python(_PyFunction_Vectorcall+0x1b7) [0x55730eed67e7]
[frame 40]: /var/run/palsd/a1b478ab-f7f5-4573-8567-e5e0d3011204/files/python(_PyEval_EvalFrameDefault+0x4c0) [0x55730eedfe60]
[frame 41]: /var/run/palsd/a1b478ab-f7f5-4573-8567-e5e0d3011204/files/python(_PyFunction_Vectorcall+0x1b7) [0x55730eed67e7]
[frame 42]: /var/run/palsd/a1b478ab-f7f5-4573-8567-e5e0d3011204/files/python(_PyEval_EvalFrameDefault+0x4c0) [0x55730eedfe60]
[frame 43]: /var/run/palsd/a1b478ab-f7f5-4573-8567-e5e0d3011204/files/python(_PyFunction_Vectorcall+0x1b7) [0x55730eed67e7]
[frame 44]: /var/run/palsd/a1b478ab-f7f5-4573-8567-e5e0d3011204/files/python(_PyEval_EvalFrameDefault+0x71b) [0x55730eee00bb]
[frame 45]: /var/run/palsd/a1b478ab-f7f5-4573-8567-e5e0d3011204/files/python(_PyEval_EvalCodeWithName+0x260) [0x55730eed5600]
[frame 46]: /var/run/palsd/a1b478ab-f7f5-4573-8567-e5e0d3011204/files/python(_PyFunction_Vectorcall+0x594) [0x55730eed6bc4]
[frame 47]: /var/run/palsd/a1b478ab-f7f5-4573-8567-e5e0d3011204/files/python(_PyEval_EvalFrameDefault+0x1510) [0x55730eee0eb0]
[frame 48]: /var/run/palsd/a1b478ab-f7f5-4573-8567-e5e0d3011204/files/python(_PyEval_EvalCodeWithName+0x260) [0x55730eed5600]
[frame 49]: /var/run/palsd/a1b478ab-f7f5-4573-8567-e5e0d3011204/files/python(_PyFunction_Vectorcall+0x594) [0x55730eed6bc4]
[frame 50]: /var/run/palsd/a1b478ab-f7f5-4573-8567-e5e0d3011204/files/python(+0x166b2e) [0x55730ee6fb2e]
[frame 51]: /var/run/palsd/a1b478ab-f7f5-4573-8567-e5e0d3011204/files/python(_PyEval_EvalFrameDefault+0x1510) [0x55730eee0eb0]
[frame 52]: /var/run/palsd/a1b478ab-f7f5-4573-8567-e5e0d3011204/files/python(_PyEval_EvalCodeWithName+0xd5f) [0x55730eed60ff]
[frame 53]: /var/run/palsd/a1b478ab-f7f5-4573-8567-e5e0d3011204/files/python(_PyFunction_Vectorcall+0x594) [0x55730eed6bc4]
[frame 54]: /var/run/palsd/a1b478ab-f7f5-4573-8567-e5e0d3011204/files/python(_PyEval_EvalFrameDefault+0x71b) [0x55730eee00bb]
[frame 55]: /var/run/palsd/a1b478ab-f7f5-4573-8567-e5e0d3011204/files/python(_PyFunction_Vectorcall+0x1b7) [0x55730eed67e7]
[frame 56]: /var/run/palsd/a1b478ab-f7f5-4573-8567-e5e0d3011204/files/python(_PyEval_EvalFrameDefault+0x71b) [0x55730eee00bb]
[frame 57]: /var/run/palsd/a1b478ab-f7f5-4573-8567-e5e0d3011204/files/python(_PyEval_EvalCodeWithName+0xd5f) [0x55730eed60ff]
[frame 58]: /var/run/palsd/a1b478ab-f7f5-4573-8567-e5e0d3011204/files/python(_PyFunction_Vectorcall+0x594) [0x55730eed6bc4]
[frame 59]: /var/run/palsd/a1b478ab-f7f5-4573-8567-e5e0d3011204/files/python(_PyEval_EvalFrameDefault+0x1510) [0x55730eee0eb0]
[frame 60]: /var/run/palsd/a1b478ab-f7f5-4573-8567-e5e0d3011204/files/python(_PyEval_EvalCodeWithName+0xd5f) [0x55730eed60ff]
[frame 61]: /var/run/palsd/a1b478ab-f7f5-4573-8567-e5e0d3011204/files/python(_PyFunction_Vectorcall+0x594) [0x55730eed6bc4]
[frame 62]: /var/run/palsd/a1b478ab-f7f5-4573-8567-e5e0d3011204/files/python(_PyEval_EvalFrameDefault+0x1510) [0x55730eee0eb0]
[frame 63]: /var/run/palsd/a1b478ab-f7f5-4573-8567-e5e0d3011204/files/python(_PyEval_EvalCodeWithName+0xd5f) [0x55730eed60ff]
[frame 64]: /var/run/palsd/a1b478ab-f7f5-4573-8567-e5e0d3011204/files/python(_PyFunction_Vectorcall+0x594) [0x55730eed6bc4]
[frame 65]: /var/run/palsd/a1b478ab-f7f5-4573-8567-e5e0d3011204/files/python(_PyEval_EvalFrameDefault+0x71b) [0x55730eee00bb]
[frame 66]: /var/run/palsd/a1b478ab-f7f5-4573-8567-e5e0d3011204/files/python(_PyEval_EvalCodeWithName+0x260) [0x55730eed5600]
[frame 67]: /var/run/palsd/a1b478ab-f7f5-4573-8567-e5e0d3011204/files/python(PyEval_EvalCode+0x23) [0x55730eed6eb3]
[frame 68]: /var/run/palsd/a1b478ab-f7f5-4573-8567-e5e0d3011204/files/python(+0x242622) [0x55730ef4b622]
[frame 69]: /var/run/palsd/a1b478ab-f7f5-4573-8567-e5e0d3011204/files/python(+0x2531d2) [0x55730ef5c1d2]
[frame 70]: /var/run/palsd/a1b478ab-f7f5-4573-8567-e5e0d3011204/files/python(+0x25636b) [0x55730ef5f36b]
[frame 71]: /var/run/palsd/a1b478ab-f7f5-4573-8567-e5e0d3011204/files/python(PyRun_SimpleFileExFlags+0x1bf) [0x55730ef5f54f]
[frame 72]: /var/run/palsd/a1b478ab-f7f5-4573-8567-e5e0d3011204/files/python(Py_RunMain+0x3a9) [0x55730ef5fa29]
[frame 73]: /var/run/palsd/a1b478ab-f7f5-4573-8567-e5e0d3011204/files/python(Py_BytesMain+0x39) [0x55730ef5fc29]
[frame 74]: /lib64/libc.so.6(__libc_start_main+0xed) [0x14d28bac534d]
[frame 75]: /var/run/palsd/a1b478ab-f7f5-4573-8567-e5e0d3011204/files/python(+0x1f9ad7) [0x55730ef02ad7]
Current pipeline object is no longer valid.
Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.